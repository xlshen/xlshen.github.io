function BoomBase(){}function Booming(a,b){this.boomItem=document.createElement("span"),this.boomItem.innerHTML=a,BoomBase.option.boomBox.appendChild(this.boomItem),this.boomItem.option=Object.assign({},b,{left:this.boomItem.offsetLeft,width:this.boomItem.offsetWidth,color:"#"+(~~(Math.random()*(1<<24))).toString(16)}),this._init()}var boomBox,message,requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(a){return setTimeout(a,10)},cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(a){clearTimeout(a)};BoomBase._boomWaitingArray=[],BoomBase._optimize=[],BoomBase.prototype={constructor:BoomBase,_init:function(){BoomBase._boomWaitingArray.push(this.boomItem),this.centralControl(BoomBase._boomWaitingArray.shift())},centralControl:function a(){var e,c=this,d=!0;if(0===BoomBase._optimize.length)for(e=0;e<BoomBase.option._boomTrackNum;e++)BoomBase._optimize[e]={},BoomBase._optimize[e].toRight=!0,BoomBase._optimize[e].obj=null;for(e=0;e<BoomBase._optimize.length;e++)if(BoomBase._optimize[e].toRight){c.fire(e),d=!1;break}d&&setTimeout(a.bind(this),0)},fire:function(a){BoomBase._optimize[a].toRight=!1,BoomBase._optimize[a].obj=this;var b=this;this.start=null,this.prev=null,this._leftMax=this.boomItem.option.width,this.wholeLine=b._leftMax+BoomBase.option._boomWidth,this._left=BoomBase.option._boomWidth,this.boomItem.style.top=20*a+"px",this.boomItem.style.color=this.boomItem.option.color,this.timer=requestAnimationFrame(function c(d){var e,f;if(b.start||(b.start=d,b.prev=d),e=d-b.start,1e4>e){if(b._left<=-b._leftMax)return cancelAnimationFrame(b.timer),b.boomItem.parentNode.removeChild(b.boomItem),void 0;b._left-=b.wholeLine*(d-b.prev)/1e4,b.boomItem.style.left=b._left+"px",b.prev=d,BoomBase._optimize[a].obj._left<BoomBase.option._boomWidth-BoomBase._optimize[a].obj._leftMax-BoomBase.option.minDistance&&(BoomBase._optimize[a].toRight=!0),requestAnimationFrame(c)}else f=e-1e4,b._left-=b.wholeLine*f/1e4,b.boomItem.style.left=b._left+"px",cancelAnimationFrame(b.timer),b.boomItem.parentNode.removeChild(b.boomItem)})},_random:function(a,b){return a+~~(Math.random()*(b-a))}},Booming.prototype=Object.create(BoomBase.prototype),Booming.prototype.constructor=Booming,boomBox=document.getElementById("boomBox"),BoomBase.option={minDistance:54,liveTime:10,boomBox:boomBox,boomItemFont:18,_boomWidth:boomBox.offsetWidth||0,_boomHeight:boomBox.offsetHeight||0,_boomTrackNum:~~(boomBox.offsetHeight/20)||0},document.addEventListener("click",function(a){if("send"===a.target.id){var b=document.querySelector(".danmaku").value;if(!b)return;new Booming(b)}}),document.querySelector(".danmaku").onkeydown=function(a){if(a=a||window.event,13===a.keyCode){var b=document.querySelector(".danmaku").value;new Booming(b)}},message=["小主","老铁","小老板","华佗在世","皮老师","神抽狗","吃瓜小强","土豆爱地瓜","小土豆","狗哥","算了吧","二师兄","小可爱","煎饼果子","向日葵妲己","猎头小哥哥","拓优吴彦祖","我不是黄蓉","我是黄老邪","胡飞雪","雪上飞狐","白发魔女","小主","老铁","小老板","华佗在世","皮老师","神抽狗","吃瓜小强","土豆爱地瓜","小土豆","狗哥","算了吧","二师兄","小可爱","肉夹馍","小姐姐","小哥哥","吴彦祖","我是黄蓉","我是黄老邪","胡飞雪","雪上飞狐","白发魔女"],!function(){for(var a=0;a<message.length;a++)new Booming(message[a])}();
